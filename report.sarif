{ "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [ {"tool": { "driver": {"name": "Jtest","semanticVersion": "2021.1.0","rules": [{ "id": "BD.RES.LEAKS", "shortDescription": { "text": "リソースが割り当て解除されていることを確認する" }, "fullDescription": { "text": "リソースが割り当て解除されていることを確認する [BD.RES.LEAKS]" }, "defaultConfiguration": { "level": "error" }, "help": { "text": "リソースが割り当て解除されていることを確認する [BD.RES.LEAKS]" }, "properties": { "tags": [ "フロー解析", "リソース" ] } }, { "id": "BD.EXCEPT.NP", "shortDescription": { "text": "NullPointerException を避ける" }, "fullDescription": { "text": "NullPointerException を避ける [BD.EXCEPT.NP]" }, "defaultConfiguration": { "level": "error" }, "help": { "text": "NullPointerException を避ける [BD.EXCEPT.NP]" }, "properties": { "tags": [ "フロー解析", "例外" ] } }, { "id": "PB.PDS", "shortDescription": { "text": "各 switch 文には default: を用意する" }, "fullDescription": { "text": "各 switch 文には default: を用意する [PB.PDS]" }, "defaultConfiguration": { "level": "warning" }, "help": { "text": "各 switch 文には default: を用意する [PB.PDS]" }, "properties": { "tags": [ "バグの可能性" ] } }, { "id": "UC.AURV", "shortDescription": { "text": "決して読まれないローカル変数の使用を避ける" }, "fullDescription": { "text": "決して読まれないローカル変数の使用を避ける [UC.AURV]" }, "defaultConfiguration": { "level": "warning" }, "help": { "text": "決して読まれないローカル変数の使用を避ける [UC.AURV]" }, "properties": { "tags": [ "未使用コード" ] } }] } }, "results": [{ "ruleId": "BD.RES.LEAKS", "level": "error", "message": { "text": "ストリームがクローズされていない: Files.walk(RESTRICTED_ZONE.toPath(), FileVisitOption.FOLLOW_LINKS)" }, "partialFingerprints": { "lineHash": "966396553" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 18, "startColumn": 14, "endLine": 19, "endColumn": 37 } } } ], "codeFlows": [ { "threadFlows": [ { "locations": [ { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 18, "startColumn": 14, "endColumn": 80 } }, "message": { "text": "Violation Cause - リソースが割り当てられるポイント  *** 割り当てられたリソース変数: Files.walk(RESTRICTED_ZONE.toPath(), FileVisitOption.FOLLOW_LINKS)" } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 19, "startColumn": 16, "endColumn": 36 } } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 18, "startColumn": 14, "endLine": 19, "endColumn": 37 } }, "message": { "text": "Violation Point - 割り当てられたリソースが失われるポイント  *** 割り当てられたリソース変数: Files.walk(RESTRICTED_ZONE.toPath(), FileVisitOption.FOLLOW_LINKS)" } }, "nestingLevel": 0 } ] } ] } ] }, { "ruleId": "UC.AURV", "level": "warning", "message": { "text": "変数 rs は決して使用されない" }, "partialFingerprints": { "lineHash": "-1528935681" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 26, "startColumn": 14, "endColumn": 16 } } } ] }, { "ruleId": "BD.RES.LEAKS", "level": "error", "message": { "text": "JDBC Resultset がクローズされていない: stmt.resultSet(), rs" }, "partialFingerprints": { "lineHash": "-993227778" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 29, "startColumn": 3, "endColumn": 4 } } } ], "codeFlows": [ { "threadFlows": [ { "locations": [ { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 25, "startColumn": 4, "endColumn": 43 } } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 26, "startColumn": 4, "endColumn": 43 } }, "message": { "text": "Violation Cause - リソースが割り当てられるポイント  *** 割り当てられたリソース変数: stmt.resultSet(), rs" } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 29, "startColumn": 3, "endColumn": 4 } }, "message": { "text": "Violation Point - 割り当てられたリソースが失われるポイント  *** 割り当てられたリソース変数: stmt.resultSet(), rs" } }, "nestingLevel": 0 } ] } ] } ] }, { "ruleId": "BD.RES.LEAKS", "level": "error", "message": { "text": "JDBC 文がクローズされていない: stmt" }, "partialFingerprints": { "lineHash": "-993227778" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 29, "startColumn": 3, "endColumn": 4 } } } ], "codeFlows": [ { "threadFlows": [ { "locations": [ { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 25, "startColumn": 4, "endColumn": 43 } }, "message": { "text": "Violation Cause - リソースが割り当てられるポイント  *** 割り当てられたリソース変数: stmt" } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 26, "startColumn": 4, "endColumn": 43 } }, "message": { "text": "  *** Statement.executeQuery() が SQLException をスロー" } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/FOLLOW.java" }, "region": { "startLine": 29, "startColumn": 3, "endColumn": 4 } }, "message": { "text": "Violation Point - 割り当てられたリソースが失われるポイント  *** 割り当てられたリソース変数: stmt" } }, "nestingLevel": 0 } ] } ] } ] }, { "ruleId": "UC.AURV", "level": "warning", "message": { "text": "変数 l は決して使用されない" }, "partialFingerprints": { "lineHash": "-233121709" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 5, "startColumn": 8, "endColumn": 9 } } } ] }, { "ruleId": "PB.PDS", "level": "warning", "message": { "text": "switch 文に default: ラベルがない" }, "partialFingerprints": { "lineHash": "1863717104" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 6, "startColumn": 3, "endColumn": 9 } } } ] }, { "ruleId": "BD.EXCEPT.NP", "level": "error", "message": { "text": "\"str\" は null の可能性がある" }, "partialFingerprints": { "lineHash": "-1372030694" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 19, "startColumn": 3, "endColumn": 24 } } } ], "codeFlows": [ { "threadFlows": [ { "locations": [ { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 14, "startColumn": 3, "endColumn": 17 } } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 15, "startColumn": 3, "endColumn": 23 } }, "message": { "text": "Violation Cause - NULL 値のソース  *** NULL 値のキャリア: str  *** 条件評価: (str != null) (false を仮定)" } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 19, "startColumn": 3, "endColumn": 24 } }, "message": { "text": "Violation Point - NullPointerException ポイント  *** NULL 値のキャリア: str" } }, "nestingLevel": 0 } ] } ] } ] }, { "ruleId": "BD.EXCEPT.NP", "level": "error", "message": { "text": "\"str\" は null の可能性がある" }, "partialFingerprints": { "lineHash": "-1372030694" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 19, "startColumn": 3, "endColumn": 24 } } } ], "codeFlows": [ { "threadFlows": [ { "locations": [ { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 24, "startColumn": 3, "endColumn": 21 } }, "message": { "text": "Violation Cause - NULL 値のソース  *** NULL 値のキャリア: str" } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 27, "startColumn": 3, "endColumn": 28 } } }, "nestingLevel": 0 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 14, "startColumn": 3, "endColumn": 17 } }, "message": { "text": "  *** NULL 値のキャリア: str" } }, "nestingLevel": 1 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 15, "startColumn": 3, "endColumn": 23 } }, "message": { "text": "  *** 条件評価: (str != null) (false)" } }, "nestingLevel": 1 }, { "location": { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 19, "startColumn": 3, "endColumn": 24 } }, "message": { "text": "Violation Point - NullPointerException ポイント  *** NULL 値のキャリア: str" } }, "nestingLevel": 1 } ] } ] } ] }, { "ruleId": "UC.AURV", "level": "warning", "message": { "text": "変数 ret は決して使用されない" }, "partialFingerprints": { "lineHash": "1472156855" }, "locations": [ { "physicalLocation": { "artifactLocation": { "uri": "file://DESKTOP-BEN2462/C:/Users/amahisa/project/git/MySample/src/org/apricott/SampleClass.java" }, "region": { "startLine": 27, "startColumn": 7, "endColumn": 10 } } } ] }] } ] }